[2024-06-24T04:48:36.484+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: snowflake_connector3.snowfalke_task1 manual__2024-06-24T04:48:34.369225+00:00 [queued]>
[2024-06-24T04:48:36.495+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: snowflake_connector3.snowfalke_task1 manual__2024-06-24T04:48:34.369225+00:00 [queued]>
[2024-06-24T04:48:36.496+0000] {taskinstance.py:1361} INFO - Starting attempt 1 of 1
[2024-06-24T04:48:36.511+0000] {taskinstance.py:1382} INFO - Executing <Task(SnowflakeOperator): snowfalke_task1> on 2024-06-24 04:48:34.369225+00:00
[2024-06-24T04:48:36.520+0000] {standard_task_runner.py:57} INFO - Started process 2520 to run task
[2024-06-24T04:48:36.525+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'snowflake_connector3', 'snowfalke_task1', 'manual__2024-06-24T04:48:34.369225+00:00', '--job-id', '40', '--raw', '--subdir', 'DAGS_FOLDER/staging/rbroker/dag.py', '--cfg-path', '/tmp/tmpvqwx3r4k']
[2024-06-24T04:48:36.529+0000] {standard_task_runner.py:85} INFO - Job 40: Subtask snowfalke_task1
[2024-06-24T04:48:36.596+0000] {task_command.py:416} INFO - Running <TaskInstance: snowflake_connector3.snowfalke_task1 manual__2024-06-24T04:48:34.369225+00:00 [running]> on host b00a3d1afa8e
[2024-06-24T04:48:36.708+0000] {taskinstance.py:1662} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='Airflow' AIRFLOW_CTX_DAG_ID='snowflake_connector3' AIRFLOW_CTX_TASK_ID='snowfalke_task1' AIRFLOW_CTX_EXECUTION_DATE='2024-06-24T04:48:34.369225+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2024-06-24T04:48:34.369225+00:00'
[2024-06-24T04:48:36.709+0000] {sql.py:274} INFO - Executing: ['select 1;', 'show tables in database abcd_db;']
[2024-06-24T04:48:36.723+0000] {base.py:73} INFO - Using connection ID 'my_snowflake_conn' for task execution.
[2024-06-24T04:48:36.735+0000] {base.py:73} INFO - Using connection ID 'my_snowflake_conn' for task execution.
[2024-06-24T04:48:36.735+0000] {connection.py:334} INFO - Snowflake Connector for Python Version: 3.3.1, Python Version: 3.8.18, Platform: Linux-6.3.13-linuxkit-x86_64-with-glibc2.2.5
[2024-06-24T04:48:36.737+0000] {connection.py:1103} INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
[2024-06-24T04:48:36.738+0000] {connection.py:1113} INFO - THIS CONNECTION IS IN INSECURE MODE. IT MEANS THE CERTIFICATE WILL BE VALIDATED BUT THE CERTIFICATE REVOCATION STATUS WILL NOT BE CHECKED.
[2024-06-24T04:48:36.739+0000] {connection.py:1121} INFO - Setting use_openssl_only mode to False
[2024-06-24T04:48:36.853+0000] {ssl_wrap_socket.py:100} INFO - THIS CONNECTION IS IN INSECURE MODE. IT MEANS THE CERTIFICATE WILL BE VALIDATED BUT THE CERTIFICATE REVOCATION STATUS WILL NOT BE CHECKED.
[2024-06-24T04:48:37.170+0000] {taskinstance.py:1937} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/providers/common/sql/operators/sql.py", line 280, in execute
    output = hook.run(
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/providers/snowflake/hooks/snowflake.py", line 382, in run
    with closing(self.get_conn()) as conn:
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/providers/snowflake/hooks/snowflake.py", line 276, in get_conn
    conn = connector.connect(**conn_config)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/__init__.py", line 54, in Connect
    return SnowflakeConnection(**kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 382, in __init__
    self.connect(**kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 662, in connect
    self.__open_connection()
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 935, in __open_connection
    self.authenticate_with_retry(self.auth_class)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 1220, in authenticate_with_retry
    self._authenticate(auth_instance)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 1246, in _authenticate
    auth.authenticate(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/auth/_auth.py", line 400, in authenticate
    Error.errorhandler_wrapper(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/errors.py", line 290, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/errors.py", line 348, in hand_to_other_handler
    connection.errorhandler(connection, cursor, error_class, error_value)
  File "/home/airflow/.local/lib/python3.8/site-packages/snowflake/connector/errors.py", line 221, in default_errorhandler
    raise error_class(
snowflake.connector.errors.DatabaseError: 250001 (08001): None: Failed to connect to DB: ct36992.ca-central-1.aws.snowflakecomputing.com:443. Role 'CA-CENTRAL-1' specified in the connect string does not exist or not authorized. Contact your local system administrator, or attempt to login with another role, e.g. PUBLIC.
[2024-06-24T04:48:37.182+0000] {taskinstance.py:1400} INFO - Marking task as FAILED. dag_id=snowflake_connector3, task_id=snowfalke_task1, execution_date=20240624T044834, start_date=20240624T044836, end_date=20240624T044837
[2024-06-24T04:48:37.200+0000] {standard_task_runner.py:104} ERROR - Failed to execute job 40 for task snowfalke_task1 (250001 (08001): None: Failed to connect to DB: ct36992.ca-central-1.aws.snowflakecomputing.com:443. Role 'CA-CENTRAL-1' specified in the connect string does not exist or not authorized. Contact your local system administrator, or attempt to login with another role, e.g. PUBLIC.; 2520)
[2024-06-24T04:48:37.224+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 1
[2024-06-24T04:48:37.257+0000] {taskinstance.py:2778} INFO - 0 downstream tasks scheduled from follow-on schedule check
